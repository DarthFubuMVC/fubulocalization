<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>
    <title>
      Architecture | FubuLocalization
    </title><meta charset="utf-8" />
<meta content="FubuWorld" name="description" />
<meta content="FubuWorld" name="author" />



<link type="text/css" rel="stylesheet" href="/fubulocalization/_content/styles/sons-of-obsidian.css" />
<link type="text/css" rel="stylesheet" href="/fubulocalization/_content/styles/toastr.css" />
<link type="text/css" rel="stylesheet" href="/fubulocalization/_content/styles/twitter/bootstrap.min.css" />
<link type="text/css" rel="stylesheet" href="/fubulocalization/_content/styles/twitter/bootstrap-responsive.min.css" />
<link type="text/css" rel="stylesheet" href="/fubulocalization/_content/styles/toastr-responsive.css" />
<link type="text/css" rel="stylesheet" href="/fubulocalization/_content/styles/fubuworld.core.css" />

<link href="http://fonts.googleapis.com/css?family=Oswald:400,300" rel="stylesheet" type="text/css" media="screen" />
  </head>
  <body data-target=".bs-docs-sidebar" data-spy="scroll">
    <div class="container">
      
      

<div class="row">
  <div class="span6">
    <p class="logo">
      <a title="Fubu" href="/fubulocalization/topics"><span>Fubu</span></a>
      <a class="project-logo" title="Localization the Fubu way" href="/fubulocalization/fubulocalization"><span>FubuLocalization</span></a>
    </p>
  </div>
  <div class="span6">
    <div class="top-header text-right">
      <em>
        <em><a href="https://groups.google.com/forum/?fromgroups#%21forum/fubumvc-devel">Join our vibrant mailing list</a></em>
      </em>
      <div class="social">
        <a class="ico-github" href="http://github.com/DarthFubuMVC/FubuLocalization"><img src="/fubulocalization/_content/images/github-icon.png" alt="Github" /></a>
      </div>
    </div>
  </div>
</div>

      <div class="navbar" id="nav-follow">
        <div class="navbar-inner">
          <div class="container">
            <ul class="nav"><li><a data-key="index" href="/fubulocalization/fubulocalization">FubuLocalization »</a></li><li class="active"><a data-key="architecture" href="/fubulocalization/fubulocalization/architecture">Architecture »</a></li></ul>
<ul style="float:right" class="nav"><li><a title="Introduction" href="/fubulocalization/fubulocalization/intro">Previous</a></li><li><a title="Basic Implementations" href="/fubulocalization/fubulocalization/basic">Next</a></li></ul>
          </div>
        </div>
      </div>
      <hr />
      <div class="row">
        

        <div class="row">
          <div class="span3 sidebar">
            <h3 class="half-margin">Topics</h3>
            <ul class="nav nav-tabs nav-stacked affix-top" id="page-toc">
            <li><a href="#undefined">LocalizationManager</a></li><li><a href="#undefined">Property Tokens</a></li><li><a href="#undefined">ILocalizationDataProvider</a></li><li><a href="#undefined">ILocaleCache</a></li><li><a href="#undefined">ILocalizationMissingHandler</a></li><li><a href="#undefined">ILocalizationStorage</a></li></ul>
            <br />
            <h3 class="no-margin">Next</h3>
<p><a data-key="basic" href="/fubulocalization/fubulocalization/basic">Basic Implementations</a></p>
<h3 class="no-margin">Previous</h3>
<p><a data-key="intro" href="/fubulocalization/fubulocalization/intro">Introduction</a></p>
          </div>
          <div class="span9">
            <h1 class="no-margin">Architecture</h1><hr class="header-line" />
             <!--Title: Architecture-->
<p></p><section><h4 class="section-header" id="manager">LocalizationManager</h4>
  <br />
    The <code>LocalizationManager</code> class is simply a <code>static facade</code> for the <code>ILocalizationDataProvider</code> interface. The reasoning
    for this is because the <code>StringToken</code> class overrides its <code>ToString</code> method to statically render itself as localized. For both
    testing and extensibility purposes, the <code>LocalizationManager</code> class exposes a static <code>RegisterProvider</code> method that allows the configured instance of
    <code>ILocalizationDataProvider</code> to be overridden by supplying a <code>Func&lt;ILocalizationDataProvider&gt;</code>.</section><p></p>

<p></p><section><h4 class="section-header" id="property-tokens">Property Tokens</h4>
    <br />
    <p>The <code>PropertyToken</code> class is the canonical way of referring to a localized property of a particular object. It is responsible for generating
    the property <code>StringToken key</code> for the property by using both the <code>parent type</code> and the <code>name</code> of the property.
    The <code>key</code> generated by the <code>PropertyToken</code> looks like: </p>
    </section>  <p></p>

  <pre class="prettyprint lang-cs linenums:124 prettyprinted" data-linenums="124" style=""><ol class="linenums"><li value="124" class="L3"><span class="pln">        </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">string</span><span class="pln"> </span><span class="typ">StringTokenKey</span></li><li class="L4"><span class="pln">        </span><span class="pun">{</span></li><li class="L5"><span class="pln">            get</span></li><li class="L6"><span class="pln">            </span><span class="pun">{</span></li><li class="L7"><span class="pln">                </span><span class="kwd">return</span><span class="pln"> </span><span class="str">"{0}:{1}:Header"</span><span class="pun">.</span><span class="typ">ToFormat</span><span class="pun">(</span><span class="typ">ParentTypeName</span><span class="pun">,</span><span class="pln"> </span><span class="typ">PropertyName</span><span class="pun">);</span></li><li class="L8"><span class="pln">            </span><span class="pun">}</span></li><li class="L9"><span class="pln">        </span><span class="pun">}</span></li></ol></pre>

  <p>Often times multiple models (i.e., view models) are used in systems to refer to the same domain concept. It is typically desirable for all of those models
  to leverage the same localization mechanics to centralize the information. The <code>PropertyToken</code> class provides an overloaded constructor for the <code>parent type</code> to be
  explicitly provided.</p>

<p></p><section><h4 class="section-header" id="provider">ILocalizationDataProvider</h4>
</section><p></p>

<p></p><p>The rest of this section will discuss how the basic <code>LocalizationDataProvider</code> works as well as its dependencies (which you can swap out at any point).</p>

<p></p><section><h4 class="section-header" id="storage">ILocaleCache</h4>
    <br />
    The <code>ILocaleCache</code> interface is used to cache the various localization lookups. The basic implementation is a thread-safe in-memory cache called
    <code>ThreadSafeLocaleCache</code>. The interface provides methods for reading from and writing to the cache:<p></p></section><p></p>

  <pre class="prettyprint lang-cs linenums:7 prettyprinted" data-linenums="7" style=""><ol class="linenums"><li value="7" class="L6"><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">interface</span><span class="pln"> </span><span class="typ">ILocaleCache</span></li><li class="L7"><span class="pln">    </span><span class="pun">{</span></li><li class="L8"><span class="pln">        </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Append</span><span class="pun">(</span><span class="typ">LocalizationKey</span><span class="pln"> key</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">string</span><span class="pln"> value</span><span class="pun">);</span></li><li class="L9"><span class="pln">        </span><span class="kwd">string</span><span class="pln"> </span><span class="typ">Retrieve</span><span class="pun">(</span><span class="typ">LocalizationKey</span><span class="pln"> key</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Func</span><span class="str">&lt;string&gt;</span><span class="pln"> missing</span><span class="pun">);</span></li><li class="L0"><span class="pln">        </span><span class="typ">CultureInfo</span><span class="pln"> </span><span class="typ">Culture</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> get</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span></li><li class="L1"><span class="pln">    </span><span class="pun">}</span></li></ol></pre>

<p></p><section><h4 class="section-header" id="missing">ILocalizationMissingHandler</h4>
    <br />
    The <code>ILocalizationMissingHandler</code> is called when a <code>LocalizationKey</code> does not exist in the cache. The default implementation,
    <code>LocalizationMissingHandler</code>, simply leverages existing default values and delegates to the storage interface for retrieving/writing information. </section><p></p>

  <pre class="prettyprint lang-cs linenums:6 prettyprinted" data-linenums="6" style=""><ol class="linenums"><li value="6" class="L5"><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">interface</span><span class="pln"> </span><span class="typ">ILocalizationMissingHandler</span></li><li class="L6"><span class="pln">    </span><span class="pun">{</span></li><li class="L7"><span class="pln">        </span><span class="kwd">string</span><span class="pln"> </span><span class="typ">FindMissingText</span><span class="pun">(</span><span class="typ">StringToken</span><span class="pln"> key</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CultureInfo</span><span class="pln"> culture</span><span class="pun">);</span></li><li class="L8"><span class="pln">        </span><span class="kwd">string</span><span class="pln"> </span><span class="typ">FindMissingProperty</span><span class="pun">(</span><span class="typ">PropertyToken</span><span class="pln"> property</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CultureInfo</span><span class="pln"> culture</span><span class="pun">);</span></li><li class="L9"><span class="pln">    </span><span class="pun">}</span></li></ol></pre>

<p></p><section><h4 class="section-header" id="storage">ILocalizationStorage</h4>
    <br />
    <p>The <code>ILocaliationStorage</code> interface is the most commonly overridden dependency. It allows you to specify the underlying peristence mechanism for all localized values.
    Out of the box, <code>FubuLocalization</code> has a basic XML implementation that leverages the local file system. This is explained in further detail in the next topic.</p></section><p></p>



            </div>
        </div>
      </div>
    </div>
    <script src="/fubulocalization/_content/scripts/jquery-1.8.2.min.js" type="text/javascript"></script>
<script src="/fubulocalization/_content/scripts/prettify.js" type="text/javascript"></script>
<script src="/fubulocalization/_content/scripts/bootstrap-prettify.js" type="text/javascript"></script>
<script src="/fubulocalization/_content/scripts/fubuworld.js" type="text/javascript"></script>
<script src="/fubulocalization/_content/scripts/toastr.js" type="text/javascript"></script>
<script src="/fubulocalization/_content/scripts/twitter/bootstrap.min.js" type="text/javascript"></script>
<script src="/fubulocalization/_content/scripts/fubudocs-tools.js" type="text/javascript"></script>
<script src="/fubulocalization/_content/scripts/twitter/bootstrap-affix.js" type="text/javascript"></script>
<script src="/fubulocalization/_content/scripts/topics.js" type="text/javascript"></script>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
    </p>
    <p>
      Powered by <a href="http://github.com/DarthFubuMVC/FubuWorld">FubuDocs</a>.
    </p>
    <p>
      Code licensed under the <a target="_blank" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License v2.0</a>.
    </p>
  </div>
</footer>
  
</body></html>